@using System.Text
@model IList<Google.Apis.Calendar.v3.Data.Event>

@{

	StringBuilder sb = new();

	sb.AppendLine($"Events for today:");
	sb.AppendLine($"{DateTime.Now.Date.ToString("D")}");

	ViewBag.Title = sb;
}

<h2><pre>@ViewBag.Title</pre></h2>

@if (Model != null && Model.Count > 0)
{
	<ul class="todays-event" style="list-style-type: none; text-align:center;">
		@foreach (var calendarEvent in Model)
		{
			<li>
				<strong>@calendarEvent.Summary</strong>

				@if (calendarEvent.Start.DateTimeDateTimeOffset.HasValue && calendarEvent.End.DateTimeDateTimeOffset.HasValue)
				{
					<!-- Timed Event -->
					<p>Start: @calendarEvent.Start.DateTimeDateTimeOffset.Value.ToLocalTime().ToString("MMMM dd, yyyy h:mm tt")</p>
					<p>End: @calendarEvent.End.DateTimeDateTimeOffset.Value.ToLocalTime().ToString("MMMM dd, yyyy h:mm tt")</p>
				}
				else if (!string.IsNullOrEmpty(calendarEvent.Start.Date) && !string.IsNullOrEmpty(calendarEvent.End.Date))
				{
					<!-- All-Day Event -->
					<br />
					<p>Date: @DateTime.Parse(calendarEvent.Start.Date).ToString("MMMM dd, yyyy")</p>
				}

				@if (!string.IsNullOrEmpty(calendarEvent.Description))
				{
					<p>Description: @calendarEvent.Description</p>
				}

			</li>
		}
	</ul>
}
else
{
	<br />
	<p class="todays-event warning">No events found for today.</p>
}